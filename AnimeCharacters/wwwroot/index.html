<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>AnimeCharacters</title>
    <base href="/" />

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <script src="js/bootstrap/bootstrap.bundle.min.js"></script>

    <link href="css/app.css" rel="stylesheet" />
    <link href="AnimeCharacters.styles.css" rel="stylesheet" />
    <link href="manifest.json" rel="manifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <script src="_content/MatBlazor/dist/matBlazor.js"></script>
    <link href="_content/MatBlazor/dist/matBlazor.css" rel="stylesheet" />
</head>

<body>
    <div id="app">
        <div class="app-spinner">
            <div class="spinner-border text-secondary" style="width: 3rem; height: 3rem;" role="status">
                <span class="visually-hidden">&nbsp;</span>
            </div>
        </div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>
        window.updateAvailable = new Promise((resolve, reject) => {
            if (!('serviceWorker' in navigator)) {
                const errorMessage = `This browser doesn't support service workers`;
                console.error(errorMessage);
                reject(errorMessage);
                return;
            }

            navigator.serviceWorker.register('service-worker.js')
                .then(registration => {
                    console.info(`Service worker registration successful (scope: ${registration.scope})`);

                    setInterval(() => {
                        registration.update();
                    }, 60 * 1000); // check each minute

                    registration.onupdatefound = () => {
                        const installingServiceWorker = registration.installing;
                        installingServiceWorker.onstatechange = () => {
                            if (installingServiceWorker.state === 'installed') {
                                resolve(!!navigator.serviceWorker.controller);
                            }
                        }
                    };
                })
                .catch(error => {
                    console.error('Service worker registration failed with error:', error);
                    reject(error);
                });
        });

        window.registerForUpdateAvailableNotification = (caller, methodName) => {
            window.updateAvailable.then(isUpdateAvailable => {
                if (isUpdateAvailable) {
                    caller.invokeMethodAsync(methodName).then();
                }
            });
        };
    </script>
</body>

</html>
